{
  "type": "service",
  "name": "www",
  "description": "Webserver for public web app.",
  "secrets": {
    "mongodb-uri": {}
  },
  "components": [
    {
      "name": "www",
      "ports": [
        {
          "name": "http",
          "port": 3000,
          "protocol": "HTTP",
          "external_access": {
            "public": true
          }
        }
      ],
      "build": {
        "git_repository": {
          "url": "https://github.com/doug-ol/coinfolio.git",
          "commit": "44fb1bd13edf63b0d034db685c7e18910d78a54b"
        },
        "language": "ruby:2.4.0",
        "command": "apt update && apt-get install -y nodejs && bundle install"
      },
      "exec": {
        "command": [
          "rails",
          "s"
        ],
        "environment": {
          "MONGOLAB_URI": { "secret": "mongodb-uri" }
        }
      }
    }
  ],
  "resources": {
    "num_instances": 1,
    "instance_type": "t2.small"
  }
}

